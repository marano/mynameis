<!DOCTYPE html>
<html>
  <head>
    <link rel="stylesheet/less" type="text/css" href="css/viewport.less" />
    <link rel="stylesheet/less" type="text/css" href="css/sidebar.less" />
    <link rel="stylesheet/less" type="text/css" href="css/map-view.less" />
    <link rel="stylesheet/less" type="text/css" href="css/balloon.less" />
    <link rel="stylesheet" type="text/css" href="vendor/animate.css" />
    <script src="vendor/lodash.js"></script>
    <script src="vendor/jquery-2.1.1.js"></script>
    <script src="vendor/jquery.transit.min.js"></script>
    <script src="vendor/knockout-3.2.0.js"></script>
    <script src="vendor/knockout.punches.min.js"></script>
    <script src="vendor/less.js"></script>
    <script src="vendor/dragdealer.js"></script>
    <script src="js/utils.js"></script>
    <script src="js/World.js"></script>
    <script src="js/WorldTile.js"></script>
    <script src="js/WorldObject.js"></script>
    <script src="js/WorldObjectFactory.js"></script>
    <script src="js/UIElement.js"></script>
    <script src="js/router/Route.js"></script>
    <script src="js/router/OpenTile.js"></script>
    <script src="js/router/ExpandedTile.js"></script>
    <script src="js/view_models/GameViewModel.js"></script>
    <script src="js/view_models/WorldObjectViewModel.js"></script>
    <script src="js/view_models/MapViewModel.js"></script>
    <script src="js/view_models/MapTileViewModel.js"></script>
    <script src="js/view_models/SidebarViewModel.js"></script>
    <script src="js/view_models/UIElementViewModel.js"></script>
    <script src="js/initializer.js"></script>
  </head>
  <body>
    <div id="viewport">
        <div class="canvas" data-bind="template: {name: 'map-view-template', data: map}"></div>
    </div>

    <div data-bind="template: {name: 'sidebar-template', data: sidebar}"></div>

    <script type="text/html" id="sidebar-template">
        <div id="sidebar" data-bind="if: game.map.selectedTile">
          <div data-bind="template: {name: 'sidebar-object-item-template', foreach: game.worldObjectsInSelectedTile, as: 'object'}"></div>
        </div>
    </script>

    <script type="text/html" id="sidebar-object-item-template">
        <div class="selected-object-name">{{object.worldObject.name}}</div>
        <div class="actions" data-bind="template: {name: 'sidebar-object-item-action-template', foreach: object.worldObject.sidebarActions, as: 'action'}"></div>
    </script>

    <script type="text/html" id="sidebar-object-item-action-template">
        <div class="action {{action.name}}" data-bind="click: $root.sidebar.initiateMoveToSelection, event: {mouseover: $root.sidebar.mouseover}, css: {'active': $root.sidebar.moving}">{{action.name}}</div>
    </script>

    <script type="text/html" id="map-view-template">
        <div class="map-grid" data-bind="template: {name: 'map-view-row-template', foreach: lines, as: 'line'}"></div>
    </script>

    <script type="text/html" id="map-view-row-template">
        <div class="row">
            <div data-bind="template: {name: 'map-view-tile-template', foreach: line, as: 'tile'}"></div>
        </div>
    </script>

    <script type="text/html" id="map-view-tile-template">
        <div class="tile" data-bind="click: onClick, template: {name: 'ui-element-template', foreach: tile.uiElements, as: 'uiElement'}"></div>
    </script>

    <script type="text/html" id="ui-element-template">
        <div id="{{uiElement.elementId}}" class="ui-element {{uiElement.classesToApply}}">{{uiElement.worldUiElement.content}}</div>
    </script>
  </body>
</html>
